<!--
  This is a minimal example of using Monaco Editor with LSP support in the browser.
  You need to:
    1. Serve this file (and dependencies) via a local web server.
    2. Start your LSP server and a WebSocket bridge (see LSP_SETUP.md).
    3. Install dependencies: monaco-editor, monaco-languageclient, vscode-ws-jsonrpc, and ws (for the bridge).
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bengali Editor with LSP</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;700&display=swap" rel="stylesheet">
  <style>
    html, body, #container { height: 100%; margin: 0; padding: 0; }
    #container { width: 100vw; height: 100vh; }
  </style>
</head>
<body>
  <div id="container"></div>
  <script type="module">
    import * as monaco from 'monaco-editor';
    import { MonacoLanguageClient } from 'monaco-languageclient';
    import { CloseAction, ErrorAction } from 'vscode-languageserver-protocol';
    import * as rpc from 'vscode-ws-jsonrpc';
    import { WebSocketMessageReader, WebSocketMessageWriter, toSocket } from "vscode-ws-jsonrpc";

    const editor = monaco.editor.create(document.getElementById('container'), {
      value: '',
      language: 'plaintext',
      fontFamily: 'Noto Sans Bengali, sans-serif',
      fontSize: 18,
      theme: 'vs-light',
      minimap: { enabled: false }
    });

    const url = 'ws://localhost:3001'; // Your LSP WebSocket bridge
    const webSocket = new WebSocket(url);
    const reader = new WebSocketMessageReader(toSocket(webSocket));
    const writer = new WebSocketMessageWriter(toSocket(webSocket));

    webSocket.onopen = () => {
      const languageClient = new MonacoLanguageClient({
        name: 'Bengali LSP',
        clientOptions: {
          documentSelector: ['plaintext'],
          errorHandler: {
            error: () => ErrorAction.Continue,
            closed: () => CloseAction.Restart,
          },
        },
        connectionProvider: {
          get: async () => ({
            reader,
            writer,
          })
        }
      });
      languageClient.start();
      webSocket.onclose = () => languageClient.stop();
    };
  </script>
</body>
</html>
